<!DOCTYPE html>
<html lang="<%= currentLanguage %>">
<head>
  <%- include('partials/head') %>
  <title>VILNIUS TECH | <%= t('dashboard.title') %></title>
</head>
<body>
  <div class="dash">
    <!-- Sidebar -->
    <%- include('partials/sidebar') %>

    <!-- Main -->
    <main class="main">
      <!-- Topbar -->
      <%- include('partials/header') %>

      <!-- Content grid -->
      <section class="grid">
        <!-- Announcement -->
         <article class="card hero">
          <div class="card-head">
            <h2><%= t('dashboard.welcomeBack', { username: user.username }) %></h2>
            <span class="badge"><%= t('dashboard.info') %></span>
          </div>
          <p class="hero-title"><%= t('dashboard.systemStatus') %></p>
          <p class="muted">
            <%= t('dashboard.loggedInAs') %> <strong><%= user.role %></strong>. 
            <% if(user.role === 'admin') { %>
                <%= t('dashboard.adminHint') %>
            <% } else { %>
                <%= t('dashboard.studentHint') %>
            <% } %>
          </p>
          <div class="hero-actions">
            <% if(user.role === 'admin') { %>
            <a class="btn" href="/admin/students" role="button"><%= t('dashboard.manageStudents') %></a>
            <% } %>
          </div>
        </article>

        <% if(user.role === 'admin') { %>
          <article class="card">
            <div class="card-head">
              <h2><%= t('dashboard.sendNotification') %></h2>
              <span class="badge"><%= t('dashboard.admin') %></span>
            </div>
            <form action="/notifications/admin/broadcast" method="POST" class="profile-change-form">
              <input type="hidden" name="_csrf" value="<%= csrfToken %>">
              <input
                type="text"
                name="title"
                class="profile-change-input"
                placeholder="<%= t('dashboard.notificationTitle') %>"
                required
                maxlength="120"
              >
              <textarea
                name="message"
                class="profile-change-input"
                placeholder="<%= t('dashboard.notificationMessage') %>"
                rows="4"
                required
                maxlength="1200"
              ></textarea>
              <button type="submit" class="btn profile-change-submit"><%= t('dashboard.sendAll') %></button>
            </form>
          </article>
        <% } %>

        <% if(success_msg && success_msg.length > 0){ %>
            <div class="alert alert-success" style="grid-column: span 3;">
                <%= success_msg %>
            </div>
        <% } %>
        <% if(error_msg && error_msg.length > 0){ %>
            <div class="alert alert-danger" style="grid-column: span 3;">
                <%= error_msg %>
            </div>
        <% } %>

        <!-- Stats row can remain or be dynamic later -->
        <!-- Just keeping the layout structure -->

      </section>

      <%- include('partials/footer') %>
    </main>
  </div>
</body>
</html>
